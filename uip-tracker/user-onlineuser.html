<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UIP Attendance Tracker</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.bootstrap5.min.css">
  <!-- Google Material Icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <!-- Custom CSS -->
  <link rel="stylesheet" href="user-onlineuser.css" />
</head>
<body>
    <aside class="sidebar">
      <div class="sidebar-header">
        <img src="logo.png" alt="logo" />
        <span class="logo-text">UIP <br>Tracker</span>
      </div>
      <ul class="sidebar-links">
        <li><a href="user-dashboard.html"><span class="material-symbols-outlined">dashboard</span>Dashboard</a></li>
        <li><a href="user-attendance.html" class="active"><span class="material-symbols-outlined">calendar_month</span>Attendance<span class="chevron">&gt;</span></a></li>
        <li><a href="user-onlineuser.html"><span class="material-symbols-outlined">account_circle</span>Online Users<span class="chevron">&gt;</span></a></li>
        <li><a href="user-event.html"><span class="material-symbols-outlined">notifications_active</span>Event<span class="chevron">&gt;</span></a></li>
        <li><a href="user-help.html"><span class="material-symbols-outlined">help</span>Help<span class="chevron">&gt;</span></a></li>
        <li><a href="user-developers.html"><span class="material-symbols-outlined">deployed_code</span>Developers<span class="chevron">&gt;</span></a></li>
      </ul>
    </aside>

    <main class="main-content">
      <!-- Header -->
      <div class="header">
        <h2 id="currentDateTime"></h2>
        <button class="user-profile" onclick="toggleDropdown()">
          <div class="user-avatar">DC</div>
          <div class="user-details">
            <h3>Dani Dela Cruz</h3>
            <p>Intern</p>
          </div>
          <span class="material-symbols-outlined" style="color: #9197B3;">expand_more</span>
          <div class="dropdown-menu" id="userDropdown">
            <a href="#" class="dropdown-item"><span class="material-symbols-outlined">person</span>Profile</a>
            <a href="#" class="dropdown-item"><span class="material-symbols-outlined">settings</span>Change Password</a>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item"><span class="material-symbols-outlined">logout</span>Sign out</a>
          </div>
        </button>
      </div>

      <!-- Active Intern Now -->
      <div class="card mb-4">
        <div class="card-header">
          <div class="table-actions">
            <div class="dropdown">
              <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="sortBtn" data-bs-toggle="dropdown" aria-expanded="false">Sort</button>
              <ul class="dropdown-menu" aria-labelledby="sortBtn">
                <li><a class="dropdown-item sort-option" href="#" data-table="internTable" data-column="1">Name</a></li>
                <li><a class="dropdown-item sort-option" href="#" data-table="internTable" data-column="2">Last Login</a></li>
                <li><a class="dropdown-item sort-option" href="#" data-table="internTable" data-column="3">Status</a></li>
              </ul>
            </div>
            <button id="copyBtn" class="btn btn-sm btn-primary">Copy</button>
            <button id="excelBtn" class="btn btn-sm btn-primary">Excel</button>
            <button id="pdfBtn" class="btn btn-sm btn-primary">PDF</button>
          </div>
          <h3 class="mb-0 card-title-centered">Active Intern Now</h3>
          <div class="search-bar">
            <input type="text" id="internSearch" class="form-control form-control-sm" placeholder="Search...">
          </div>
        </div>
        <div class="card-body">
          <table id="internTable" class="table table-striped table-bordered" style="width:100%">
            <thead>
              <tr>
                <th>Profile</th>
                <th>Name</th>
                <th>Last Login</th>
                <th>Status</th>
                <th>Position</th>
                <th>Team Name</th>
                <th>Company</th>
              </tr>
            </thead>
            <tbody>
              <!-- Intern data will be inserted here dynamically -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Active Staff Now -->
      <div class="card">
        <div class="card-header">
          <div class="table-actions">
             <div class="dropdown">
              <button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="staffSortBtn" data-bs-toggle="dropdown" aria-expanded="false">Sort</button>
              <ul class="dropdown-menu" aria-labelledby="staffSortBtn">
                <li><a class="dropdown-item sort-option" href="#" data-table="staffTable" data-column="1">Name</a></li>
                <li><a class="dropdown-item sort-option" href="#" data-table="staffTable" data-column="2">Last Login</a></li>
                <li><a class="dropdown-item sort-option" href="#" data-table="staffTable" data-column="3">Status</a></li>
              </ul>
            </div>
            <button id="staffCopyBtn" class="btn btn-sm btn-primary">Copy</button>
            <button id="staffExcelBtn" class="btn btn-sm btn-primary">Excel</button>
            <button id="staffPdfBtn" class="btn btn-sm btn-primary">PDF</button>
          </div>
          <h3 class="mb-0 card-title-centered">Active Staff Now</h3>
          <div class="search-bar">
            <input type="text" id="staffSearch" class="form-control form-control-sm" placeholder="Search...">
          </div>
        </div>
        <div class="card-body">
          <table id="staffTable" class="table table-striped table-bordered" style="width:100%">
            <thead>
              <tr>
                <th>Profile</th>
                <th>Name</th>
                <th>Last Login</th>
                <th>Status</th>
                <th>Position</th>
                <th>Team Name</th>
                <th>Company</th>
              </tr>
            </thead>
            <tbody>
              <!-- Staff data will be inserted here dynamically -->
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
    <!-- DataTables Buttons extension -->
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.bootstrap5.min.js"></script>
    <!-- Export to Excel / PDF / Copy -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>

    <script>
    $(document).ready(function () {
      // Sample data for interns
      const internData = [
        { profile: "profile1.png", name: "Smith, John D.", lastLogin: "08/10/2024 09:00 AM", status: "ONLINE", position: "IT Intern", team: "Group 1", company: "Vynics Travel" },
        { profile: "profile2.png", name: "Doe, Jane M.", lastLogin: "08/10/2024 08:30 AM", status: "OFFLINE", position: "IT Intern", team: "Group 2", company: "Vynics Travel" },
        { profile: "profile4.png", name: "Lee, Bruce W.", lastLogin: "08/10/2024 09:15 AM", status: "ONLINE", position: "Marketing Intern", team: "Group 1", company: "Vynics Travel" },
        { profile: "profile5.png", name: "Garcia, Maria C.", lastLogin: "08/09/2024 05:00 PM", status: "OFFLINE", position: "HR Intern", team: "Group 3", company: "Vynics Travel" },
      ];

      // Sample data for staff
      const staffData = [
        { profile: "profile3.png", name: "Admin Account", lastLogin: "08/10/2024 08:00 AM", status: "ONLINE", position: "Admin", team: "N/A", company: "UP Inc." },
        { profile: "profile6.png", name: "Johnson, Robert", lastLogin: "08/10/2024 08:55 AM", status: "ONLINE", position: "Supervisor", team: "IT", company: "UP Inc." },
      ];

      // Populate intern table
      const internTableBody = $("#internTable tbody");
      internData.forEach((intern) => {
        const statusClass = intern.status === "ONLINE" ? "online" : "offline";
        const row = `
          <tr>
            <td class="text-center"><img src="${intern.profile}" alt="profile" class="profile-pic"><span class="status-icon ${statusClass}"></span></td>
            <td>${intern.name}</td>
            <td>${intern.lastLogin}</td>
            <td><span class="badge bg-${statusClass === 'online' ? 'success' : 'secondary'}">${intern.status}</span></td>
            <td>${intern.position}</td>
            <td>${intern.team}</td>
            <td>${intern.company}</td>
          </tr>`;
        internTableBody.append(row);
      });

      // Populate staff table
      const staffTableBody = $("#staffTable tbody");
      staffData.forEach((staff) => {
        const statusClass = staff.status === "ONLINE" ? "online" : "offline";
        const row = `
          <tr>
            <td class="text-center"><img src="${staff.profile}" alt="profile" class="profile-pic"><span class="status-icon ${statusClass}"></span></td>
            <td>${staff.name}</td>
            <td>${staff.lastLogin}</td>
            <td><span class="badge bg-${statusClass === 'online' ? 'success' : 'secondary'}">${staff.status}</span></td>
            <td>${staff.position}</td>
            <td>${staff.team}</td>
            <td>${staff.company}</td>
          </tr>`;
        staffTableBody.append(row);
      });

      // Common DataTable options
      const dataTableOptions = {
        pageLength: 5,
        // FIX: Position pagination and info correctly using Bootstrap grid classes
        dom: 't<"row pt-3"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7"p>>',
        buttons: [
          { extend: 'copyHtml5', className: 'd-none' }, 
          { extend: 'excelHtml5', className: 'd-none' }, 
          { extend: 'pdfHtml5', className: 'd-none' }
        ],
        language: {
          search: "_INPUT_",
          searchPlaceholder: "Search..."
        }
      };
      
      // Initialize DataTables
      const internTable = $("#internTable").DataTable(dataTableOptions);
      const staffTable = $("#staffTable").DataTable(dataTableOptions);

      // FIX: Link custom search bars to DataTables API
      $("#internSearch").on("keyup", function () {
        internTable.search(this.value).draw();
      });
      $("#staffSearch").on("keyup", function () {
        staffTable.search(this.value).draw();
      });

      // Export buttons triggers
      $('#copyBtn').on('click', function() { internTable.button('.buttons-copy').trigger(); });
      $('#excelBtn').on('click', function() { internTable.button('.buttons-excel').trigger(); });
      $('#pdfBtn').on('click', function() { internTable.button('.buttons-pdf').trigger(); });

      $('#staffCopyBtn').on('click', function() { staffTable.button('.buttons-copy').trigger(); });
      $('#staffExcelBtn').on('click', function() { staffTable.button('.buttons-excel').trigger(); });
      $('#staffPdfBtn').on('click', function() { staffTable.button('.buttons-pdf').trigger(); });

      // Sort functionality
      $('.sort-option').on('click', function(e) {
        e.preventDefault();
        const tableId = $(this).data('table');
        const column = $(this).data('column');
        const table = $(`#${tableId}`).DataTable();
        table.order([column, 'asc']).draw();
      });
    });

    // Time updater
    function updateTime() {
      const now = new Date();
      const month = now.toLocaleString('en-US', { month: 'long' });
      const day = now.getDate();
      const year = now.getFullYear();
      const time = now.toLocaleString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true });
      const weekday = now.toLocaleString('en-US', { weekday: 'long' });
      document.getElementById('currentDateTime').textContent = `${month} ${day}, ${year} | ${time} | ${weekday}`;
    }
    updateTime();
    setInterval(updateTime, 1000);

    // Dropdown functionality
    function toggleDropdown() {
      document.getElementById('userDropdown').classList.toggle('show');
    }
    document.addEventListener('click', function(event) {
      const userProfile = document.querySelector('.user-profile');
      if (!userProfile.contains(event.target)) {
        document.getElementById('userDropdown').classList.remove('show');
      }
    });
    </script>
</body>
</html>